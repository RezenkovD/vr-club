function t_customMask__caret(e,t,n){var a;if(e&&"none"!==e.style.display)return"number"==typeof t?(n="number"==typeof n?n:t,e.setSelectionRange?e.setSelectionRange(t,n):e.createTextRange&&((a=e.createTextRange()).collapse(!0),a.moveEnd("character",n),a.moveStart("character",t),a.select()),e):(e.setSelectionRange?(t=e.selectionStart,n=e.selectionEnd):document.selection&&document.selection.createRange&&(n=(t=0-(a=document.selection.createRange()).duplicate().moveStart("character",-1e5))+a.text.length),{begin:t,end:n})}function t_customMask__unmask(e){return t_triggerEvent(e,"unmask")}function t_customMask__mask(o,t,u){var e,n,s,i,c,r,l=[],d=null;if(!t&&o){var a=window.tildaCustomMaskSetting.defaultSetting.dataName;return a?a():void 0}u=Object.assign({},{autoclear:window.tildaCustomMaskSetting.defaultSetting.autoclear,placeholder:window.tildaCustomMaskSetting.defaultSetting.placeholder,completed:null},u),e=window.tildaCustomMaskSetting.defaultSetting.definitions,s=c=t.length,n=(t=String(t)).split("");for(var v=0;v<n.length;v++){var f=n[v];"?"===f?(c--,s=v):e[f]?(l.push(new RegExp(e[f])),null===d&&(d=l.length-1),v<s&&(i=l.length-1)):l.push(null)}for(var m=[],v=0;v<n.length;v++){var g=n[v];"?"!==g&&(e[g]?m.push(p(v)):m.push(g))}var _=m.join(""),h=o.value;function p(e){return e<u.placeholder.length?u.placeholder.charAt(e):u.placeholder.charAt(0)}function k(){if(u.completed){for(var e=d;e<=i;e++)if(l[e]&&m[e]===p(e))return;u.completed=o}}function w(e){for(;++e<c&&!l[e];);return e}function b(e,t){var n=w(t);if(!(e<0)){for(var a=e;a<c;a++)if(l[a]){if(!(n<c&&l[a].test(m[n])))break;m[a]=m[n],m[n]=p(n),n=w(n)}C(),t_customMask__caret(o,Math.max(d,e))}}function M(){function e(){t_customMask__caret(o,n.begin,n.begin)}var t=o.value,n=t_customMask__caret(o);if(r&&r.length&&r.length>t.length){for(var t=O(!0),a=n.end;0<a&&!l[a-1];)a--;0===a&&(a=t),n.begin=a,setTimeout(function(){e(),k()},0)}else n.begin=O(!0),setTimeout(function(){e(),k()},0);r=o.value}function S(){O(),o.value!=h&&o.change&&o.change(),!o.value&&o.classList.contains("t-input_has-content")&&o.classList.remove("t-input_has-content")}function E(e){var t,n,a;o.readOnly||(t=(e=e||window.event).keyCode||e.which,r=o.value,8===t||46===t||window.tildaCustomMaskSetting.iPhone&&127===t?(n=(a=t_customMask__caret(o)).begin,(a=a.end)-n==0&&(n=46!==t?function(e){for(;0<=--e&&!l[e];);return e}(n):a=w(n-1),a=46===t?w(a):a),L(n,a),b(n,a-1),e.preventDefault?e.preventDefault():e.returnValue=!1):13===t?S():27===t&&(o.value=h,t_customMask__caret(o,0,O()),e.preventDefault?e.preventDefault():e.returnValue=!1))}function y(e){var t,n,a,r;o.readOnly||(r=(e=e||window.event).keyCode||e.which,t=t_customMask__caret(o),17===r||18===r||91===r||93===r||r<32||r&&13!==r&&(t.end-t.begin!=0&&(L(t.begin,t.end),b(t.begin,t.end-1)),(n=w(t.begin-1))<c&&(r=String.fromCharCode(r),l[n].test(r)&&(function(e){for(var t,n,a=p(e),r=e;r<c;r++)if(l[r]){if(t=w(r),n=m[r],m[r]=a,!(t<c&&l[t].test(n)))break;a=n}}(n),m[n]=r,C(),a=w(n),window.tildaCustomMaskSetting.android?setTimeout(function(){t_customMask__caret(o,a)},0):t_customMask__caret(o,a),t.begin<=i&&k())),e.preventDefault?e.preventDefault():e.returnValue=!1))}function L(e,t){for(var n=e;n<t&&n<c;n++)l[n]&&(m[n]=p(n))}function C(){o.value=m.join("")}function O(e){for(var t,n=o.value,a=-1,r=0,i=0;i<c;i++)if(l[i]){for(m[i]=p(i);r++<n.length;)if(t=n.charAt(r-1),l[i].test(t)){m[i]=t,a=i;break}if(r>n.length){L(i+1,c);break}}else m[i]===n.charAt(r)&&r++,i<s&&(a=i);return e?C():a+1<s?u.autoclear||m.join("")===_?(o.value&&(o.value=""),L(0,c)):C():(C(),o.value=o.value.substring(0,a+1)),s?i:d}function T(){var e;o.readOnly||(clearTimeout(window.tildaCustomMaskSetting.caretTimeoutId),h=o.value,e=O(),window.tildaCustomMaskSetting.caretTimeoutId=setTimeout(function(){C(),e==t.replace("?","").length?t_customMask__caret(o,0,e):setTimeout(function(){t_customMask__caret(o,e)},50)},10))}function j(){var e;o.readOnly||(0===o.getAttribute("data-tilda-mask").indexOf("+7")&&(0===(e=o.value.replace(/\D/g,"")).indexOf("78")&&(o.value=e.substring(2)),0!==e.indexOf("8")&&0!==e.indexOf("7")||(o.value=e.substring(1))),setTimeout(function(){var e=O(!0);t_customMask__caret(o,e),k()},0))}var x="focus",A="blur";document.addEventListener||(x="focusin",A="focusout"),t_addEventListener(o,x,T),t_addEventListener(o,A,S),t_addEventListener(o,"paste",j),t_addEventListener(o,"unmask",function e(){for(var t=document.querySelectorAll(".js-tilda-mask"),n=0;n<t.length;n++){var a=t[n];t_removeEventListener(a,x,T),t_removeEventListener(a,A,S),t_removeEventListener(a,"keydown",E),t_removeEventListener(a,"keypress",y),t_removeEventListener(a,"input",j),t_removeEventListener(a,"paste",j),t_removeEventListener(a,"unmask",e)}},{once:!0}),window.tildaCustomMaskSetting.chrome&&window.tildaCustomMaskSetting.android?(t_removeEventListener(o,"input",M),t_addEventListener(o,"input",M)):(t_addEventListener(o,"input",j),t_addEventListener(o,"keydown",E),t_addEventListener(o,"keypress",y)),O()}"function"!=typeof Object.assign&&(Object.assign=function(e){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");e=Object(e);for(var t=1;t<arguments.length;t++){var n=arguments[t];if(null!=n)for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}),function(){var e=navigator.userAgent;window.tildaCustomMaskSetting={iPhone:/iphone/i.test(e),chrome:/chrome/i.test(e),android:/android/i.test(e),caretTimeoutId:0,defaultSetting:{definitions:{9:"[0-9]",a:"[A-Za-z]","а":"[А-Яа-яЁё]","*":"[A-Za-zА-Яа-яЁё0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"}}}();